<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Modern Tetris</title>
  <!-- uiEnhancements is imported inside main.ts; removed duplicate script include to prevent double MutationObservers & event handlers -->
  <style>
    :root { color-scheme: dark; }
    * { box-sizing: border-box; }
    html, body { height:100%; }
    body { margin:0; font-family: system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif; background: radial-gradient(circle at 30% 20%, #1f2535 0%, #0d1016 70%); color:#e5e7eb; -webkit-font-smoothing: antialiased; }
  #stage { padding:10px 12px; }
  .app-shell { display:flex; gap:18px; align-items:flex-start; justify-content:center; max-width:900px; margin:0 auto; }
    @media (max-width: 760px){ .app-shell { flex-direction:column; align-items:stretch; gap:20px; } #stage{ padding:12px 10px 40px; } }
    canvas { background:#06080d; display:block; image-rendering:pixelated; box-shadow:0 0 0 1px rgba(255,255,255,0.06),0 4px 16px -4px rgba(0,0,0,0.8); border-radius:6px; }
    @media (max-width: 380px) { canvas { width:240px; height:480px; } }
    /* Prevent accidental scroll / bounce when interacting */
    canvas, .control-grid, button { touch-action:none; -webkit-touch-callout:none; }
    #gameWrap { position:relative; }
    #overlay { position:absolute; inset:0; display:flex; align-items:center; justify-content:center; font-size:54px; font-weight:700; letter-spacing:2px; font-family:inherit; background:rgba(0,0,0,0.55); backdrop-filter: blur(2px); color:#fff; opacity:0; transition:opacity .25s; pointer-events:none; border-radius:6px; }
    #overlay.visible { opacity:1; }
  .panel { width:250px; max-width:100%; display:flex; flex-direction:column; height:600px; }
  .panel-bottom { margin-top:10px; }
  .logo-wrap { text-align:center; margin:0 0 4px; }
  .logo-wrap img { width:100%; height:auto; max-height:180px; display:block; margin:0 auto; object-fit:contain; filter:drop-shadow(0 3px 10px rgba(0,0,0,0.55)); }
  .stats { display:grid; grid-template-columns:repeat(2,1fr); gap:8px; }
  .stat { background:linear-gradient(150deg, rgba(255,255,255,0.055), rgba(255,255,255,0.02)); padding:4px 6px 5px; border-radius:10px; position:relative; box-shadow:inset 0 0 0 1px rgba(255,255,255,0.04),0 2px 4px -2px rgba(0,0,0,0.55); display:flex; flex-direction:column; justify-content:flex-start; min-height:56px; }
  .stat.emphasis { background:linear-gradient(155deg, rgba(120,156,255,0.22), rgba(120,156,255,0.07)); box-shadow:0 4px 14px -6px rgba(48,84,255,0.55), inset 0 0 0 1px rgba(255,255,255,0.08); }
  .stat-label { font-size:9px; text-transform:uppercase; letter-spacing:.8px; color:#b2b7c0; font-weight:600; }
  .stat-val { display:block; font-size:16px; font-weight:700; margin-top:0; font-variant-numeric: tabular-nums; line-height:1.05; }
    .stat.emphasis.pulse { animation:statPulse 0.65s ease; }
    @keyframes statPulse { 0%{ transform:scale(1); } 35%{ transform:scale(1.035); } 70%{ transform:scale(0.992); } 100%{ transform:scale(1); } }
  .progress-wrap { height:5px; margin-top:6px; border-radius:3px; background:rgba(255,255,255,0.10); overflow:hidden; position:relative; box-shadow:inset 0 0 0 1px rgba(0,0,0,0.35); }
  .progress-bar { position:absolute; left:0; top:0; bottom:0; width:0%; background:linear-gradient(90deg,#4f7ff9,#8b5cf6); box-shadow:0 0 0 1px rgba(255,255,255,0.1),0 0 10px -2px #4f7ff9; transition:width .25s cubic-bezier(.4,.0,.2,1); }
    .delta { font-size:12px; font-weight:600; color:#10b981; opacity:0; transform:translateY(4px); transition: all .3s; }
    .delta.visible { opacity:1; transform:translateY(0); }
    .toast-layer { position:relative; min-height:40px; }
    .toast-layer .toast { position:absolute; right:0; top:0; background:rgba(17,24,39,0.9); padding:8px 14px 9px; border-radius:8px; font-size:13px; font-weight:600; letter-spacing:.5px; animation:toastIn .35s ease; box-shadow:0 4px 14px -6px rgba(0,0,0,0.9),0 0 0 1px rgba(255,255,255,0.06); backdrop-filter: blur(4px); }
    .toast.good { background:linear-gradient(135deg, rgba(34,197,94,0.85), rgba(34,197,94,0.65)); color:#022c16; }
    .toast.out { animation:toastOut .42s ease forwards; }
    @keyframes toastIn { 0%{ opacity:0; transform:translateY(-8px) scale(.95);} 100%{ opacity:1; transform:translateY(0) scale(1);} }
    @keyframes toastOut { 0%{ opacity:1; transform:translateY(0) scale(1);} 100%{ opacity:0; transform:translateY(-8px) scale(.93);} }
    .divider { height:1px; background:linear-gradient(90deg,rgba(255,255,255,0.08),rgba(255,255,255,0.02)); }
  button { cursor:pointer; outline:none; background:linear-gradient(150deg, rgba(255,255,255,0.10), rgba(255,255,255,0.02)); color:#fff; border:1px solid rgba(255,255,255,0.14); border-radius:7px; font-size:11px; padding:5px 8px 6px; font-weight:600; letter-spacing:.35px; font-family:inherit; transition:background .15s, transform .13s, border-color .18s; position:relative; }
    button:hover { background:linear-gradient(145deg, rgba(255,255,255,0.22), rgba(255,255,255,0.05)); }
    button:active { transform:translateY(2px); }
  .control-grid { display:grid; grid-template-columns:repeat(3,30px); grid-template-rows:repeat(3,30px); gap:4px; justify-content:center; margin:6px auto 0; width:max-content; }
  .control-grid button { width:30px; height:30px; font-size:14px; font-weight:600; padding:0; display:flex; align-items:center; justify-content:center; }
  .control-grid .blank { pointer-events:none; opacity:0; }
    .foot { font-size:12px; opacity:0.65; line-height:1.4; }
    @media (max-width: 520px){ .panel { width:100%; } .app-shell { gap:16px; } .control-grid { gap:6px; } .control-grid button { width:48px; height:48px; } #gameWrap { margin:0 auto; } }
  </style>
</head>
<body>
  <div id="stage">
  <div id="root" class="app-shell">
      <div id="gameWrap" class="card-equal">
        <canvas id="game" width="300" height="600"></canvas>
        <div id="overlay" class="visible">READY</div>
      </div>
      <div class="panel">
        <div class="logo-wrap">
          <img id="gameLogo" alt="Tetris Logo" decoding="async" />
        </div>
        <div class="stats">
          <div id="score" class="stat emphasis">
            <div class="stat-top"><span class="stat-label">Score</span><span class="delta" id="scoreDelta"></span></div>
            <span id="scoreVal" class="stat-val">0</span>
            <div class="progress-wrap"><div id="levelProgress" class="progress-bar"></div></div>
          </div>
          <div id="level" class="stat"><span class="stat-label">Level</span><span id="levelVal" class="stat-val">1</span></div>
            <div id="lines" class="stat"><span class="stat-label">Lines</span><span id="linesVal" class="stat-val">0</span></div>
          <div id="highScore" class="stat"><span class="stat-label">High</span><span id="highVal" class="stat-val">0</span></div>
        </div>
        <div id="toastLayer" class="toast-layer"></div>
        <div class="panel-bottom">
          <div class="divider" style="margin:6px 0 4px;"></div>
          <div style="display:flex; gap:4px; margin-top:4px;">
            <button id="startBtn" style="flex:1;">Start</button>
            <button id="resetBtn" style="flex:1;">Reset</button>
          </div>
          <div class="divider" style="margin:6px 0 4px;"></div>
          <div class="control-grid">
            <div class="blank"></div>
            <button id="btnUp">▲</button>
            <div class="blank"></div>
            <button id="btnLeft">◀</button>
            <button id="btnDown">▼</button>
            <button id="btnRight">▶</button>
            <div class="blank"></div>
            <button id="btnHard">⤓</button>
            <div class="blank"></div>
          </div>
          <div class="foot" style="margin-top:6px; font-size:10px;">
            Keyboard: Arrows / Space / Shift / R
          </div>
        </div>
      </div>
    </div>
  </div>
  <script type="module" src="/src/main.ts"></script>
</body>
</html>
